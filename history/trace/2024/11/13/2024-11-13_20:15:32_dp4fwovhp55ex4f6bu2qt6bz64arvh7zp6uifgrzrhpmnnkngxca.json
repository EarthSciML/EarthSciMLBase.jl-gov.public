{"id":"dp4fwovhp55ex4f6bu2qt6bz64arvh7zp6uifgrzrhpmnnkngxca","stamp":"2024-11-13T20:15:32.85580727Z","payload":{"op":"motion_open","note":"","args":{"id":"76"},"result":{"motion":{"opened_at":"2024-11-13T20:15:32.838410602Z","closed_at":"0001-01-01T00:00:00Z","id":"76","type":"concern","policy":"pmp-concern-policy","author":"","tracker_url":"https://github.com/EarthSciML/EarthSciMLBase.jl/issues/76","title":"Cannot Compose a System with Algebraic Equations","description":"If we try to compose two systems with equations that have the same time derivative of the same variable, `operator_compose() `will return an error unless both systems are pure differential/reaction rate systems. For the algebraic part, `operation(term)` will return an error because `term` cannot be of type `Int64`.\r\n\r\n```using EarthSciMLBase\r\nusing Catalyst\r\nusing ModelingToolkit\r\nusing ModelingToolkit: t_nounits, D_nounits\r\nt = t_nounits\r\nD = D_nounits\r\n\r\nstruct ChemistryCoupler sys end\r\nfunction Chemistry(;name=:chemistry, rxn_sys=false)\r\n    @variables k(t) \r\n    @parameters a0 = 1 \r\n    sys1 = NonlinearSystem([k ~ a0], [k], []; name=:rate)\r\n\r\n    function rate()\r\n        return sys1.k\r\n    end\r\n    rx_sys = @reaction_network rx begin\r\n        @species(\r\n            A(t) = 20, \r\n            B(t) = 0, \r\n        )\r\n\r\n        rate(), A --\u003e B\r\n    end\r\n    rxns = compose(rx_sys, sys1) \r\n    convert(ODESystem, complete(rxns); combinatoric_ratelaws=false, name=name,metadata=Dict(:coupletype=\u003eChemistryCoupler))\r\nend\r\nsys1 = Chemistry()\r\n\r\nstruct EmisCoupler sys end\r\nfunction Emis()\r\n    @variables x(t) \r\n    @parameters p \r\n    ODESystem([D(x) ~ 2p], t; name=:Emis,\r\n        metadata=Dict(:coupletype=\u003eEmisCoupler))\r\nend\r\n\r\nsys2 = Emis()\r\n\r\noperator_compose(sys1, sys2)","labels":["gov4git:managed"],"frozen":false,"closed":false,"cancelled":false,"archived":false,"score":{"attention":0},"ref_by":null,"ref_to":null}}}}
